{"paragraphs":[{"text":"%pyspark\nimport sys\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.transforms import *\nfrom awsglue.utils import getResolvedOptions\n\n# Create a Glue context\nglueContext = GlueContext(SparkContext.getOrCreate())\n\n# Create a DynamicFrame using the 'persons_json' table\npersons_DyF = glueContext.create_dynamic_frame.from_catalog(database=\"legislators\", table_name=\"persons_json\")\n\n# Print out information about this data\nprint \"Count:  \", persons_DyF.count()\npersons_DyF.printSchema()","user":"admin","dateUpdated":"2018-05-15T18:24:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:   1961\nroot\n|-- family_name: string\n|-- name: string\n|-- links: array\n|    |-- element: struct\n|    |    |-- note: string\n|    |    |-- url: string\n|-- gender: string\n|-- image: string\n|-- identifiers: array\n|    |-- element: struct\n|    |    |-- scheme: string\n|    |    |-- identifier: string\n|-- other_names: array\n|    |-- element: struct\n|    |    |-- lang: string\n|    |    |-- note: string\n|    |    |-- name: string\n|-- sort_name: string\n|-- images: array\n|    |-- element: struct\n|    |    |-- url: string\n|-- given_name: string\n|-- birth_date: string\n|-- id: string\n|-- contact_details: array\n|    |-- element: struct\n|    |    |-- type: string\n|    |    |-- value: string\n|-- death_date: string\n\n"}]},"apps":[],"jobName":"paragraph_1526408237304_1581548520","id":"20180515-181717_159979570","dateCreated":"2018-05-15T18:17:17+0000","dateStarted":"2018-05-15T18:23:34+0000","dateFinished":"2018-05-15T18:23:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3678"},{"text":"%pyspark\nmemberships = glueContext.create_dynamic_frame.from_catalog(\n                 database=\"legislators\",\n                 table_name=\"memberships_json\")\nprint \"Count: \", memberships.count()\nmemberships.printSchema()","user":"admin","dateUpdated":"2018-05-15T18:27:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:  10439\nroot\n|-- area_id: string\n|-- on_behalf_of_id: string\n|-- organization_id: string\n|-- role: string\n|-- person_id: string\n|-- legislative_period_id: string\n|-- start_date: string\n|-- end_date: string\n\n"}]},"apps":[],"jobName":"paragraph_1526408292446_-942126785","id":"20180515-181812_1782148309","dateCreated":"2018-05-15T18:18:12+0000","dateStarted":"2018-05-15T18:27:07+0000","dateFinished":"2018-05-15T18:27:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3679"},{"text":"%pyspark\norgs = glueContext.create_dynamic_frame.from_catalog(\n           database=\"legislators\",\n           table_name=\"organizations_json\")\nprint \"Count: \", orgs.count()\norgs.printSchema()","user":"admin","dateUpdated":"2018-05-15T18:34:35+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":423,"optionOpen":false}}},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:  13\nroot\n|-- identifiers: array\n|    |-- element: struct\n|    |    |-- scheme: string\n|    |    |-- identifier: string\n|-- other_names: array\n|    |-- element: struct\n|    |    |-- lang: string\n|    |    |-- note: string\n|    |    |-- name: string\n|-- id: string\n|-- classification: string\n|-- name: string\n|-- links: array\n|    |-- element: struct\n|    |    |-- note: string\n|    |    |-- url: string\n|-- image: string\n|-- seats: int\n|-- type: string\n\n"}]},"apps":[],"jobName":"paragraph_1526408827095_1185115946","id":"20180515-182707_1735333861","dateCreated":"2018-05-15T18:27:07+0000","dateStarted":"2018-05-15T18:31:49+0000","dateFinished":"2018-05-15T18:32:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3680"},{"text":"%pyspark\norgs = orgs.drop_fields(['other_names',\n                        'identifiers']).rename_field(\n                            'id', 'org_id').rename_field(\n                               'name', 'org_name')\norgs.toDF().show()","user":"admin","dateUpdated":"2018-05-15T18:34:39+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":355,"optionOpen":false}}},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------------------+--------------------+--------------------+--------------------+-----+-----------+\n|classification|              org_id|            org_name|               links|               image|seats|       type|\n+--------------+--------------------+--------------------+--------------------+--------------------+-----+-----------+\n|         party|            party/al|                  AL|                null|                null| null|       null|\n|         party|      party/democrat|            Democrat|[[website,http://...|https://upload.wi...| null|       null|\n|         party|party/democrat-li...|    Democrat-Liberal|[[website,http://...|                null| null|       null|\n|   legislature|d56acebe-8fdc-47b...|House of Represen...|                null|                null|  435|lower house|\n|         party|   party/independent|         Independent|                null|                null| null|       null|\n|         party|party/new_progres...|     New Progressive|[[website,http://...|https://upload.wi...| null|       null|\n|         party|party/popular_dem...|    Popular Democrat|[[website,http://...|                null| null|       null|\n|         party|    party/republican|          Republican|[[website,http://...|https://upload.wi...| null|       null|\n|         party|party/republican-...|Republican-Conser...|[[website,http://...|                null| null|       null|\n|         party|      party/democrat|            Democrat|[[website,http://...|https://upload.wi...| null|       null|\n|         party|   party/independent|         Independent|                null|                null| null|       null|\n|         party|    party/republican|          Republican|[[website,http://...|https://upload.wi...| null|       null|\n|   legislature|8fa6c3d2-71dc-478...|              Senate|                null|                null|  100|upper house|\n+--------------+--------------------+--------------------+--------------------+--------------------+-----+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1526409109107_956001004","id":"20180515-183149_433616715","dateCreated":"2018-05-15T18:31:49+0000","dateStarted":"2018-05-15T18:34:23+0000","dateFinished":"2018-05-15T18:34:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3681"},{"text":"%pyspark\nmemberships.select_fields(['organization_id']).toDF().distinct().show()","user":"admin","dateUpdated":"2018-05-15T18:35:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|     organization_id|\n+--------------------+\n|d56acebe-8fdc-47b...|\n|8fa6c3d2-71dc-478...|\n+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1526409263373_-160358059","id":"20180515-183423_584776882","dateCreated":"2018-05-15T18:34:23+0000","dateStarted":"2018-05-15T18:35:50+0000","dateFinished":"2018-05-15T18:36:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3682"},{"text":"%pyspark\npersons = glueContext.create_dynamic_frame.from_catalog(\n             database=\"legislators\",\n             table_name=\"persons_json\")\nprint \"Count: \", persons.count()\npersons.printSchema()","user":"admin","dateUpdated":"2018-05-15T18:41:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:  1961\nroot\n|-- family_name: string\n|-- name: string\n|-- links: array\n|    |-- element: struct\n|    |    |-- note: string\n|    |    |-- url: string\n|-- gender: string\n|-- image: string\n|-- identifiers: array\n|    |-- element: struct\n|    |    |-- scheme: string\n|    |    |-- identifier: string\n|-- other_names: array\n|    |-- element: struct\n|    |    |-- lang: string\n|    |    |-- note: string\n|    |    |-- name: string\n|-- sort_name: string\n|-- images: array\n|    |-- element: struct\n|    |    |-- url: string\n|-- given_name: string\n|-- birth_date: string\n|-- id: string\n|-- contact_details: array\n|    |-- element: struct\n|    |    |-- type: string\n|    |    |-- value: string\n|-- death_date: string\n\n"}]},"apps":[],"jobName":"paragraph_1526409632225_1832024988","id":"20180515-184032_874481263","dateCreated":"2018-05-15T18:40:32+0000","dateStarted":"2018-05-15T18:41:31+0000","dateFinished":"2018-05-15T18:41:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3683"},{"text":"%pyspark\nl_history = Join.apply(orgs,\n                       Join.apply(persons, memberships, 'id', 'person_id'),\n                       'org_id', 'organization_id').drop_fields(['person_id', 'org_id'])\nprint \"Count: \", l_history.count()\nl_history.printSchema()","user":"admin","dateUpdated":"2018-05-15T18:41:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:  10439\nroot\n|-- role: string\n|-- seats: int\n|-- org_name: string\n|-- links: array\n|    |-- element: struct\n|    |    |-- note: string\n|    |    |-- url: string\n|-- type: string\n|-- sort_name: string\n|-- area_id: string\n|-- images: array\n|    |-- element: struct\n|    |    |-- url: string\n|-- on_behalf_of_id: string\n|-- other_names: array\n|    |-- element: struct\n|    |    |-- lang: string\n|    |    |-- note: string\n|    |    |-- name: string\n|-- name: string\n|-- birth_date: string\n|-- organization_id: string\n|-- gender: string\n|-- classification: string\n|-- death_date: string\n|-- legislative_period_id: string\n|-- identifiers: array\n|    |-- element: struct\n|    |    |-- scheme: string\n|    |    |-- identifier: string\n|-- image: string\n|-- given_name: string\n|-- start_date: string\n|-- family_name: string\n|-- id: string\n|-- contact_details: array\n|    |-- element: struct\n|    |    |-- type: string\n|    |    |-- value: string\n|-- end_date: string\n\n"}]},"apps":[],"jobName":"paragraph_1526409350296_-406827218","id":"20180515-183550_482511383","dateCreated":"2018-05-15T18:35:50+0000","dateStarted":"2018-05-15T18:41:45+0000","dateFinished":"2018-05-15T18:42:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3684"},{"text":"%pyspark\nl_history.toDF().show()","user":"admin","dateUpdated":"2018-05-15T19:15:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"+------+-----+--------+--------------------+-----------+----------------+--------------------+--------------------+----------------+--------------------+------------------+----------+--------------------+------+--------------+----------+---------------------+--------------------+--------------------+----------+----------+-----------+--------------------+--------------------+--------+\n|  role|seats|org_name|               links|       type|       sort_name|             area_id|              images| on_behalf_of_id|         other_names|              name|birth_date|     organization_id|gender|classification|death_date|legislative_period_id|         identifiers|               image|given_name|start_date|family_name|                  id|     contact_details|end_date|\n+------+-----+--------+--------------------+-----------+----------------+--------------------+--------------------+----------------+--------------------+------------------+----------+--------------------+------+--------------+----------+---------------------+--------------------+--------------------+----------+----------+-----------+--------------------+--------------------+--------+\n|member|  100|  Senate|[[Wikipedia (ar),...|upper house|  Thompson, Fred|ocd-division/coun...|[[https://theunit...|party/republican|[[ar,multilingual...|     Fred Thompson|1942-08-19|8fa6c3d2-71dc-478...|  male|   legislature|2015-11-22|             term/103|[[allmovie,p70694...|https://theunited...|      Fred|1994-12-02|   Thompson|0fcf1022-8066-42f...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ar),...|upper house|  Thompson, Fred|ocd-division/coun...|[[https://theunit...|party/republican|[[ar,multilingual...|     Fred Thompson|1942-08-19|8fa6c3d2-71dc-478...|  male|   legislature|2015-11-22|             term/104|[[allmovie,p70694...|https://theunited...|      Fred|      null|   Thompson|0fcf1022-8066-42f...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ar),...|upper house|  Thompson, Fred|ocd-division/coun...|[[https://theunit...|party/republican|[[ar,multilingual...|     Fred Thompson|1942-08-19|8fa6c3d2-71dc-478...|  male|   legislature|2015-11-22|             term/105|[[allmovie,p70694...|https://theunited...|      Fred|1997-01-07|   Thompson|0fcf1022-8066-42f...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ar),...|upper house|  Thompson, Fred|ocd-division/coun...|[[https://theunit...|party/republican|[[ar,multilingual...|     Fred Thompson|1942-08-19|8fa6c3d2-71dc-478...|  male|   legislature|2015-11-22|             term/106|[[allmovie,p70694...|https://theunited...|      Fred|      null|   Thompson|0fcf1022-8066-42f...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ar),...|upper house|  Thompson, Fred|ocd-division/coun...|[[https://theunit...|party/republican|[[ar,multilingual...|     Fred Thompson|1942-08-19|8fa6c3d2-71dc-478...|  male|   legislature|2015-11-22|             term/107|[[allmovie,p70694...|https://theunited...|      Fred|      null|   Thompson|0fcf1022-8066-42f...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/103|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/104|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/105|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/106|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/107|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/108|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/109|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/110|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ast)...|upper house|     Gregg, Judd|ocd-division/coun...|[[https://theunit...|party/republican|[[ast,multilingua...|        Judd Gregg|1947-02-14|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/111|[[bioguide,G00044...|https://theunited...|      Judd|      null|      Gregg|835f8433-e2a4-401...|                null|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/106|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/107|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/108|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/109|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/110|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n|member|  100|  Senate|[[Wikipedia (ace)...|upper house|Schumer, Charles|ocd-division/coun...|[[https://theunit...|  party/democrat|[[null,alternate,...|Charles E. Schumer|1950-11-23|8fa6c3d2-71dc-478...|  male|   legislature|      null|             term/111|[[ballotpedia,Chu...|https://theunited...|   Charles|      null|    Schumer|60ae8ebc-b581-44e...|[[fax,202-228-302...|    null|\n+------+-----+--------+--------------------+-----------+----------------+--------------------+--------------------+----------------+--------------------+------------------+----------+--------------------+------+--------------+----------+---------------------+--------------------+--------------------+----------+----------+-----------+--------------------+--------------------+--------+\nonly showing top 20 rows\n\n"},{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-6965553757438186128.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-6965553757438186128.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nAttributeError: 'NoneType' object has no attribute 'limit'\n\n"}]},"apps":[],"jobName":"paragraph_1526409691164_-1195656052","id":"20180515-184131_1705447696","dateCreated":"2018-05-15T18:41:31+0000","dateStarted":"2018-05-15T18:52:34+0000","dateFinished":"2018-05-15T18:52:44+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3685"},{"text":"%pyspark\nl_history.select_fields(['id']).toDF().distinct().show()","user":"admin","dateUpdated":"2018-05-15T19:11:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                  id|\n+--------------------+\n|4dee720e-a16b-436...|\n|b58ffb5e-89c4-4d3...|\n|78799ec9-b2dd-459...|\n|e7098cd7-c726-4f9...|\n|04898269-db05-4d7...|\n|9e5138de-fd9f-46c...|\n|c1e50e83-9eff-4e8...|\n|03cf9876-b6ff-431...|\n|bc1175b9-1082-4b1...|\n|cea8dec9-daf3-464...|\n|f459b622-0596-432...|\n|7d669b68-c74e-4de...|\n|ebe46992-a5b3-402...|\n|d98b2fb3-60b1-442...|\n|a22e05f3-2544-49c...|\n|46ae57f1-7c12-496...|\n|183fbf3a-9c79-475...|\n|0966663f-1c4b-4b7...|\n|89b68e74-7fad-49d...|\n|765a9cd1-0c0d-498...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1526409787924_-301994916","id":"20180515-184307_1962076942","dateCreated":"2018-05-15T18:43:07+0000","dateStarted":"2018-05-15T19:11:32+0000","dateFinished":"2018-05-15T19:11:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3686"},{"text":"%pyspark\n#aws-glue-test-legislator-data\n\nglueContext.write_dynamic_frame.from_options(frame = l_history,\n          connection_type = \"s3\",\n          connection_options = {\"path\": \"s3://aws-glue-test-legislator-data/output-dir/legislator_history\"},\n          format = \"parquet\")","user":"admin","dateUpdated":"2018-05-15T19:33:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526411491901_-994874611","id":"20180515-191131_1186000801","dateCreated":"2018-05-15T19:11:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3687","dateFinished":"2018-05-15T19:33:43+0000","dateStarted":"2018-05-15T19:33:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<awsglue.dynamicframe.DynamicFrame object at 0x7f40e5cb8c50>\n"}]}},{"text":"%pyspark\nprint \"Count: \", l_history.count()\nl_history.printSchema()","user":"admin","dateUpdated":"2018-05-15T19:28:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526412451141_1177183407","id":"20180515-192731_758110778","dateCreated":"2018-05-15T19:27:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4411","dateFinished":"2018-05-15T19:28:50+0000","dateStarted":"2018-05-15T19:28:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Count:  10439\nroot\n|-- role: string\n|-- seats: int\n|-- org_name: string\n|-- links: array\n|    |-- element: struct\n|    |    |-- note: string\n|    |    |-- url: string\n|-- type: string\n|-- sort_name: string\n|-- area_id: string\n|-- images: array\n|    |-- element: struct\n|    |    |-- url: string\n|-- on_behalf_of_id: string\n|-- other_names: array\n|    |-- element: struct\n|    |    |-- lang: string\n|    |    |-- note: string\n|    |    |-- name: string\n|-- name: string\n|-- birth_date: string\n|-- organization_id: string\n|-- gender: string\n|-- classification: string\n|-- death_date: string\n|-- legislative_period_id: string\n|-- identifiers: array\n|    |-- element: struct\n|    |    |-- scheme: string\n|    |    |-- identifier: string\n|-- image: string\n|-- given_name: string\n|-- start_date: string\n|-- family_name: string\n|-- id: string\n|-- contact_details: array\n|    |-- element: struct\n|    |    |-- type: string\n|    |    |-- value: string\n|-- end_date: string\n\n"}]}},{"text":"%pyspark\ns_history = l_history.toDF().repartition(5)\ns_history.write.mode(\"overwrite\").parquet('s3://aws-glue-test-legislator-data/output-dir/legislator_single')\n","user":"admin","dateUpdated":"2018-05-15T19:37:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526412526944_534206698","id":"20180515-192846_404194132","dateCreated":"2018-05-15T19:28:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4492","dateFinished":"2018-05-15T19:37:24+0000","dateStarted":"2018-05-15T19:37:04+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n","user":"admin","dateUpdated":"2018-05-15T19:32:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526412754274_-597048658","id":"20180515-193234_183744349","dateCreated":"2018-05-15T19:32:34+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4579"}],"name":"GlueTesting","id":"2DCQ7PPVB","angularObjects":{"2CRE5X63N:shared_process":[],"2CQZ9JC8F:shared_process":[],"2CNAPD13W:shared_process":[],"2CRC324G8:existing_process":[],"2CQ1X8PFU:shared_process":[],"2CNFC7TNE:shared_process":[],"2CMQ2EHTE:shared_process":[],"2CQUCJVJA:shared_process":[],"2CQY3SUDK:shared_process":[],"2CNA37GFQ:shared_process":[],"2CPH9H73W:shared_process":[],"2CR2XFEE3:shared_process":[],"2CQ9YVF7W:shared_process":[],"2CP1P36EU:shared_process":[],"2CMR9MKCE:shared_process":[],"2CR2YZBFW:shared_process":[],"2CPJK4U6W:shared_process":[],"2CR2Z9UR2:shared_process":[],"2CPQWHWM3:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}